"use client";

import { useLang } from "../lib/i18n";

export default function MyDataPage() {
  const { lang } = useLang();

  const exportData = async () => {
    try {
      const res = await fetch("/api/export", { method: "POST" });
      if (!res.ok) throw new Error("Export failed");
      alert(lang === "ru" ? "–≠–∫—Å–ø–æ—Ä—Ç –∑–∞–ø—Ä–æ—à–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É." : "Export requested. Check your email.");
    } catch (e) {
      alert(lang === "ru" ? "–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞" : "Export error");
      console.error(e);
    }
  };

  const deleteData = async () => {
    try {
      const res = await fetch("/api/delete", { method: "POST" });
      if (!res.ok) throw new Error("Delete failed");
      alert(lang === "ru" ? "–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—à–µ–Ω–æ." : "Deletion requested.");
    } catch (e) {
      alert(lang === "ru" ? "–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è" : "Delete error");
      console.error(e);
    }
  };

  return (
    <div style={{padding:"24px"}}>
      <h1 style={{marginBottom:16}}>{lang === "ru" ? "–ú–æ–∏ –¥–∞–Ω–Ω—ã–µ" : "My Data"}</h1>
      <div style={{display:"flex", gap:12}}>
        <button onClick={exportData} style={{padding:"10px 14px", border:"1px solid #444", borderRadius:8}}>
          üì§ {lang === "ru" ? "–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å" : "Export"}
        </button>
        <button onClick={deleteData} style={{padding:"10px 14px", border:"1px solid #444", borderRadius:8}}>
          üóëÔ∏è {lang === "ru" ? "–£–¥–∞–ª–∏—Ç—å" : "Delete"}
        </button>
      </div>
    </div>
  );
}
